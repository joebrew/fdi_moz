var ep = window.ep || {}; ep.bundles = ep.bundles || []; ep.bundles = ep.bundles.concat('bundled/ehost/result_list.js','ep/webservices/common.js', 'ep/webservices/folderwebservice.js', 'ep/webservices/pendingsearchtabservice.js', 'ep/extension/number.js', 'ep/ajaxcallback.js', 'ep/ajaxupdatefolder.js', 'ep/ajaxresultlist.js', 'ep/eprelatedinfoexternalitem.js', 'ep/eprelatedinfoexternalbehavior.js', 'ep/eprecordpreviewhover.js', 'ep/dualslider.js', 'ep/controller/control/clustercontrol.js', 'ep/controller/control/doctypecontrol.js', 'ep/controller/control/imagequickview.js', 'ep/controller/control/relatedinfocontrol.js', 'ep/controller/control/limitsyourresultscontrol.js', 'ep/controller/control/folderitemscontrol.js', 'ep/base/resultlistcontroller.js', 'ep/widgets/simpleaccordion.js', 'ep/common/alertemailed.js', 'ep/jqueryplugins/absolutize.js', 'ep/base/modaldialogcontroller.js', 'ep/base/modalpanelcontroller.js', 'ep/base/selectmultiplecontroller.js', 'ep/controller/control/breadboxcontrol.js', 'ep/controller/page/ehost/resultlistcontroller.js', 'ep/controller/control/bookjackets.js');
(function(a){if(window.EPWebServices===undefined){window.EPWebServices={};}EPWebServices.buildURL=function(e,d){e=e.replace(/^\//,"");d=d.replace(/^\//,"");var c=(this._getHid()!==null)?"?hid="+this._getHid():"";var b=location.href.split("/"+ep.interfaceId+"/")[0]+"/"+e+"/"+d+c;return b;};EPWebServices.doWebServiceCall=function(g,f,d,c,e){ep.debug("ep/webservices/common.js -> doWebServiceCall");var b=a.ajax(g,{type:"POST",contentType:"application/json",data:JSON.stringify(f),dataType:"text",success:function(m,l,j){var h;var i=j.getResponseHeader("content-type")||"";if(i.indexOf("json")>-1){var k=a.parseJSON(m);if(k!==null){h=k.d;}}else{h=m;}if(d){d(h,e);}},error:function(i,j,h){ep.debug("ajax error : "+h);if(c){c(transport.responseText,e);}}});};EPWebServices._getHid=function(){var b=window.location.toString().match(/hid=(\d+)/);if(b!==null&&b.length>1){return b[1];}else{return null;}};})(jQuery);EPWebServices.FolderWebService={};EPWebServices.FolderWebService._SERVICE_URL="/Legacy/Views/WebServices/FolderWebService.asmx";EPWebServices.FolderWebService.FolderPageAddRemove=function(i,f,g,h,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageAddRemove");var a={theSessionParams:i,theContentItem:f,theIsAdd:g,theIsRefreshFolderItems:h};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.FolderItemsAddRemove=function(i,f,g,h,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderItemsAddRemove");var a={theSessionParams:i,theContentItem:f,theIsAdd:g,theIsRefreshFolderItems:h};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.DAFolderItemsAddRemove=function(i,f,g,h,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"DAFolderItemsAddRemove");var a={theSessionParams:i,theContentItem:f,theIsAdd:g,theIsRefreshFolderItems:h};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.AddExternalFolderItems=function(f,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"AddExternalFolderItems");var a={theContentItems:f};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.RemoveExternalFolderItem=function(f,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"RemoveExternalFolderItem");var a={theContentItems:f};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.FolderItemsRefresh=function(j,h,g,i){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderItemsRefresh");var a={theSessionParams:j};var d=window.panelLoadState||{};if(d.right){ep.showPanel("rightCollapsible","PanelContainer");}else{var c=getElementById("rightCollapsiblePostBack");if(c){var e=/javascript:\s*__doPostBack\s*\(\s*'([^']+)/;var f=e.exec(c.href);if(f){__doPostBack(f[1],"");}}}EPWebServices.doWebServiceCall(b,a,h,g,i);};EPWebServices.FolderWebService.FolderReadNote=function(g,f,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderReadNote");var a={theSessionParams:g,theContentItem:f};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.FolderPageNoteAdd=function(j,f,i,g,h,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteAdd");var a={theSessionParams:j,theContentItem:f,theIsRefreshFolderItems:i,theIsArticleNote:g,theIsInViewer:h};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.FolderPageNoteDelete=function(i,f,h,g,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteDelete");var a={theSessionParams:i,theContentItem:f,theIsRefreshFolderItems:h,theIsInViewer:g};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.FolderWebService.FolderPageNoteUpdate=function(i,f,h,g,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteUpdate");var a={theSessionParams:i,theContentItem:f,theIsRefreshFolderItems:h,theIsInViewer:g};EPWebServices.doWebServiceCall(b,a,d,c,e);};EPWebServices.PendingSearchTabService={};EPWebServices.PendingSearchTabService._SERVICE_URL="/Views/WebServices/PendingSearchTabService.asmx";EPWebServices.PendingSearchTabService.ResolvePendingTabs=function(g,h,f,d,c,e){var b=EPWebServices.buildURL(this._SERVICE_URL,"ResolvePendingTabs");var a={theSessionID:g,theVersionID:h,theTabIDs:f};EPWebServices.doWebServiceCall(b,a,d,c,e);};Number.prototype.px=function(){return parseInt(this,10)+"px";};Number.isNumeric=function(a){return !isNaN(parseFloat(a))&&isFinite(a);};Number.numOrDefault=function(b,a){return ep.utilities.isNumeric(b)?b:(a||0);};var aOriginalActionPage=null;var aNativePostBack;function __doNativePostBack(b,a){window.ClearTarget();var d=getPostBackForm();var e=aOriginalActionPage;var c=getUpdatedFormAction(d,e);d.action=c;aNativePostBack(b,a);}function UpdatePostBack(){if(typeof(__doPostBack)==="function"){aOriginalActionPage=getPostBackPage(getPostBackForm(),false);aNativePostBack=__doPostBack;__doPostBack=__doNativePostBack;}}jQuery(document).ready(UpdatePostBack);function AjaxCallBack(){this.XmlHttp=getXmlHttpObject();this.eventTarget=null;this.eventArgument=null;this.readyState=(this.XmlHttp&&(this.XmlHttp.readyState===0||this.XmlHttp.readyState===4));this.redirect=null;this.autoRedirect=true;}AjaxCallBack.prototype.doPostBack=function(c,b){var g=getPostBackForm();var h=getPostBackPage(g,false);var f="__EVENTTARGET="+escape(c.split("$").join(":"))+"&";f+="__EVENTARGUMENT="+b+"&";f+="__VIEWSTATE="+escape(g.__VIEWSTATE.value).replace(new RegExp("\\+","g"),"%2b")+"&";f+="__CUSTOMVIEWSTATE="+escape(g.__CUSTOMVIEWSTATE.value).replace(new RegExp("\\+","g"),"%2b")+"&";f+="IsCallBack=true&";var a="";for(var d=0;d<g.elements.length;d++){a=g.elements[d].name;if(a&&a!==""){if(a!=="__EVENTTARGET"&&a!=="__EVENTARGUMENT"&&a!=="__VIEWSTATE"&&a!=="__CUSTOMVIEWSTATE"){f=f+escape(a.split("$").join(":"))+"="+g.elements[d].value;if(d!==g.elements.length-1){f=f+"&";}}}}if(this.XmlHttp){if(this.XmlHttp.readyState===4||this.XmlHttp.readyState===0){this.readyState=true;}else{this.readyState=false;}if(this.readyState){var e=this;this.XmlHttp.open("POST",h,true);this.XmlHttp.onreadystatechange=function(){e.ReadyStateChange();};this.XmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.XmlHttp.send(f);}this.eventTarget=c;this.eventArgument=b;}};AjaxCallBack.prototype.doCallBack=function(h,b,a){var f=getPostBackForm();var g=(!h)?getPostBackPage(f,true):h;var d=getUpdatedFormAction(f,g);var e="__EVENTTARGET="+b+"&";e+="IsCallBack=true&";e+=this.serializeFormData(f);if(a.indexOf("&")>-1){e+=a+"&";}else{e+="__EVENTARGUMENT="+a+"&";}if(this.XmlHttp){if(this.XmlHttp.readyState===4||this.XmlHttp.readyState===0){this.readyState=true;}else{this.readyState=false;}if(this.readyState){var c=this;this.XmlHttp.open("POST",d,true);this.XmlHttp.onreadystatechange=function(){c.ReadyStateChange();};this.XmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.XmlHttp.send(e);}this.eventTarget=b;this.eventArgument=a;}};AjaxCallBack.prototype.OnLoading=function(){};AjaxCallBack.prototype.OnLoaded=function(){};AjaxCallBack.prototype.OnInteractive=function(){};AjaxCallBack.prototype.OnComplete=function(){};AjaxCallBack.prototype.OnAbort=function(){};AjaxCallBack.prototype.OnError=function(){};AjaxCallBack.prototype.AbortCallBack=function(){if(this.XmlHttp){this.XmlHttp.abort();}};AjaxCallBack.prototype.ReadyStateChange=function(){if(this.XmlHttp.readyState===0){this.readyState=true;}if(this.XmlHttp.readyState===1){this.readyState=false;this.OnLoading();}else{if(this.XmlHttp.readyState===2){this.readyState=false;this.OnLoaded();}else{if(this.XmlHttp.readyState===3){this.readyState=false;this.OnInteractive();}else{if(this.XmlHttp.readyState===4){this.readyState=true;var a=this.XmlHttp.statusText;if(this.XmlHttp.status===0){this.OnAbort();}else{if(this.XmlHttp.status===200&&(!a||this.XmlHttp.statusText==="OK")){try{if(this.XmlHttp.getResponseHeader("vid")!==""){getPostBackForm().action=getFormActionWithUpdatedVID(getPostBackForm(),aOriginalActionPage,this.XmlHttp.getResponseHeader("vid"));}this.redirect=this.XmlHttp.getResponseHeader("redirect");if(this.autoRedirect){this.redirectToPage(this.redirect);}}catch(b){}this.OnComplete(this.XmlHttp.responseText,this.XmlHttp.responseXML,this.eventTarget,this.eventArgument);}else{this.OnError(this.XmlHttp.status,this.XmlHttp.statusText,this.XmlHttp.responseText);}}}}}}};AjaxCallBack.prototype.redirectToPage=function(c,a){if(c){var b=getPostBackForm();var d=getUpdatedFormAction(b,c);if(a!==undefined){d=d+a;}window.location=d;}};AjaxCallBack.prototype.serializeFormData=function(g){var a,c,e;var f="";this.add=function(h,i){f+=h+"="+encodeURIComponent(i)+"&";};for(var b=0;b<g.elements.length;b++){a=g.elements[b];c=getClientId(a.getAttribute("id"),"_");e=getClientId(a.getAttribute("name"),"$");if(!a.disabled){switch(a.type){case"hidden":if(e!=="__EVENTTARGET"&&e!=="__EVENTARGUMENT"&&e!=="__VIEWSTATE"&&e!=="__CUSTOMVIEWSTATE"&&e!=="__LASTFOCUS"){this.add(e,a.value);}break;case"text":case"textarea":case"password":this.add(c,a.value);break;case"checkbox":this.add(c,a.checked);break;case"radio":if(a.checked){this.add(e,a.value);}break;case"select-one":if(a.options[a.selectedIndex].value!==""){this.add(c,a.options[a.selectedIndex].value);}break;case"select-multiple":for(var d=0;d<a.options.length;d++){if(a.options[d].selected){this.add(c,a.options[d].value);}}break;}}}return f;};var aFolderItemID="";var aAjaxUpdateFolderIsFolderAdd=false;function SucceededCallback(b,c,a){if(aFolderItemID){ep.folder.swapItemStyle(aFolderItemID,false,aAjaxUpdateFolderIsFolderAdd);}else{window.SwapAllStyles();}}function FailedCallback(a,c,b){}function FolderItems_Toggle(c,b){aFolderItemID=c;aAjaxUpdateFolderIsFolderAdd=b;var a=new this.ep.folder.FolderItems();a.Add(window.BuildExternalFolderItem(c,true));if(b){if(a.Count()>0){if(typeof EPWebServices.FolderWebService!=="undefined"){EPWebServices.FolderWebService.AddExternalFolderItems(a.Clone(),SucceededCallback,FailedCallback);}}}else{if(a.Count()>0){if(typeof EPWebServices.FolderWebService!=="undefined"){EPWebServices.FolderWebService.RemoveExternalFolderItem(a.Clone(),SucceededCallback,FailedCallback);}}}}ep.folder.FolderItems=function(){var a=0;this.Add=function(b){if(!b){return;}a++;this[(a-1)]=b;};this.Remove=function(c){if(c<0||c>this.length-1){return;}this[c]=null;for(var b=c;b<=a;b++){this[b]=this[b+1];}a--;};this.Count=function(){return a;};this.Clear=function(){for(var b=0;b<a;b++){this[b]=null;}a=0;};this.Clone=function(){var c=new ep.folder.FolderItems();for(var b=0;b<a;b++){c.Add(this[b]);}return c;};};ep.folder.ExternalFolderItem=function(){this.ID="";this.Source="";this.Url="";this.Title="";this.Descr="";};ep.folder.ExternalFolderItemWithSID=function(){this.ID="";this.Source="";this.Url="";this.Title="";this.Descr="";this.SID="";this.VID="";};function BuildExternalFolderItem(c,b){var a=null;if(b){a=new ep.folder.ExternalFolderItemWithSID();a.SID=document.getElementById("__sid").value;a.VID=document.getElementById("__vid").value;}else{a=new ep.ExternalFolderItem();}a.ID=document.getElementById("rec_id_"+c).value;a.Source=document.getElementById("rec_source_"+c).value;a.Url=document.getElementById("rec_link_"+c).href;a.Title=document.getElementById("rec_link_"+c).innerHTML;a.Descr=document.getElementById("rec_descr_"+c).innerHTML;return a;}var aTarget="";var isFolderAdd=false;function AjaxComplete(d,e,c,b){AjaxCallBack.prototype.OnComplete();var a=null;switch(aTarget){case"ResultList":break;case"FolderItem":ep.folder.swapItemStyle(b.substring(0,b.indexOf("_")),false,isFolderAdd);ep.folder.folderItemsRefresh();break;case"AddAll":window.SwapAllStyles();ep.folder.folderItemsRefresh();break;}}function AjaxError(b,c,a){AjaxCallBack.prototype.OnError(c,a);}var aAjaxCallBack=new AjaxCallBack();if(aAjaxCallBack&&aAjaxCallBack.XmlHttp&&aAjaxCallBack.readyState){aAjaxCallBack.OnComplete=AjaxComplete;aAjaxCallBack.OnError=AjaxError;}function doCallBack(b,a){if((b.indexOf("FolderItem")>-1)){aTarget="FolderItem";isFolderAdd=b.indexOf("AddItem")>-1;aAjaxCallBack.doCallBack("",b,a);}else{if(b.match(/AddAll/).length>0){aTarget="AddAll";aAjaxCallBack.doCallBack("",b,a);}else{aAjaxCallBack.AbortCallBack();_doPostBack(b,a);}}}var EPRelatedInfoExternalItem=(function(a){var b;b=function(c,d,e){this._element=c;this._itemID="";this._itemState="";if(d){this.set_itemID(d);}if(e){this.set_itemState(e);}};b.prototype={get_itemID:function(){return this._itemID;},set_itemID:function(c){if(this._itemID!==c){this._itemID=c;}},get_itemState:function(){return this._itemState;},set_itemState:function(c){if(this._itemState!==c){jQuery(this._element).removeClass(this._itemState);this._itemState=c;jQuery(this._element).addClass(c);jQuery(this._element).children('input[name="externalitemstate"]').first().val(this._itemState);}},get_element:function(){return this._element;}};return b;}(jQuery));var EPRelatedInfoExternalBehavior=(function(a){var b;b=function(f){this._external_items=[];this._element=f;var c=a(f);var e=this;if(c.length){var d=c.find('div[id$="externalItem"]');if(d.length){d.each(function(k,j){var i=a(j).children('input[name="externalitemstate"]').first().val();var h=a(j).children('input[name="externalitemid"]').first().val();if(i===null){return true;}var g=new EPRelatedInfoExternalItem(j,h,i);e._external_items.push(g);});}}};b.prototype={has_pending_items:function(){var c=this.get_external_items();if(c&&c.length>0){for(var d=0;d<c.length;d++){if(c[d].get_itemState()==="Pending"){return true;}}}return false;},has_external_items:function(){return(this.get_external_items().length>0)?true:false;},get_external_items:function(){return this._external_items;},set_external_items:function(c){if(this._external_items!==c){this._external_items=c;this.raisePropertyChanged("externalItems");}},get_pending_items:function(){var d=[];var c=this.get_external_items();if(c&&c.length>0){for(var e=0;e<c.length;e++){if(c[e].get_itemState()==="Pending"){d.push(c[e]);}}}return d;},get_element:function(){return this._element;}};return b;}(jQuery));(function(a){ep.dialog.RecordPreview=function(){var g={};function d(p){var o=jQuery(".json-data",p);if(!o.length){return null;}var n=jQuery.parseJSON(o[0].firstChild.nodeValue);n.theHoverElement=p;return f(n,null,true);}function e(w){var p=null;var s=w+1;var u="";var n=jQuery("#hoverPreview"+s).data("hoverpreviewjson");if(n){var o=null;if(n.resultListId||n.archiveNoteItemId){o=ep.utilities.buildAjaxRequestPath("Detail/HoverPreview");u=n.resultListId;}else{if(n.db&&n.tag&&n.term){o=ep.utilities.buildAjaxRequestPath("Detail/HoverPreview",{Db:n.db,Tag:n.tag,Term:n.term});}}var q=jQuery("#hoverPreview"+s).parent().parent("ol").hasClass("related-info-list");var v=jQuery("#hoverPreview"+s).attr("targetid");var t=jQuery("#hoverPreview"+s).data("reasontext");var r={theIsRelatedInfo:q,theTargetId:v,theResultListId:u,isNovList:n.isNovList};if(n.archiveNoteItemId){r.theArchiveNoteItemId=n.archiveNoteItemId;}if(n.isNote){r.theIsNote=n.isNote;}jQuery.ajax({url:o,data:r,async:false,success:function(x){p=f(x,w,t);}});}return p;}function f(o,y,x){var s="";s+="<dl class=\"preview-detail\" data-auto='preview_detail'";if(o.ExtendedMarkupInfo&&o.ExtendedMarkupInfo!=""){s+="data-extmarkup='"+o.ExtendedMarkupInfo+"'";}s+=">";var q;var r;var p;if(o.IgnoreProperties){q="Title";r=o.DisplayValues[q];p=q;s+="<dt data-auto='preview_detail_title_hidden'";s+=' class="hidden"';s+=">"+p+":</dt><dd";s+=" data-auto='preview_detail_title' class=\"title-link\"";if(false){s+='href="'+a(o.theHoverElement).parent().find("a").attr("href")+'"';}else{s+='href="#"';}s+=">"+m(o,r,a(o.theHoverElement).parent().find("a").attr("href"))+"</dd>";o.IgnoreProperties.push("Title");}if(x){o.DisplayValues.Reason=x+o.RecommendationFeedbackTag;}for(q in o.DisplayValues){if(typeof o.DisplayValues[q]!=="function"){if(k(o.IgnoreProperties,q)){continue;}r=o.DisplayValues[q];if(r&&r.length>0){p=q;if(_.isArray(r)){r=l(r);}if(ep.clientData.hoverPreviewLabelData[q]){p=ep.clientData.hoverPreviewLabelData[q];}s+="<dt data-auto='preview_detail_info_label'";if(q==="Title"){s+=' class="hidden"';}s+=">"+p+":</dt><dd data-auto='preview_detail_info_value'";if(q==="Title"){s+=' class="title-link"';s+=">"+m(o,r)+"</dd>";}else{s+=">"+r+"</dd>";}}}}s+="</dl>";if(o.HeaderLinks||o.FooterLinks){s+="<div class=\"hover-links\" data-auto='preview_detail_links'>";}var u=o.HeaderLinks;if(u&&u.length>0&&o.TargetId){for(var v=0;v<u.length;v++){s+=c(o.TargetId,u[v]);}}else{if(o.ResultListIndex){s+=j(o.ResultListIndex);}}if(ep.dialog.RecordPreview.isShowFolderLink){s+=b(y,o);}var t=o.FooterLinks;if(t&&t.length>0&&o.TargetId){for(var w=0;w<t.length;w++){s+=c(o.TargetId,t[w]);}}else{if(o.ResultListIndex){s+=i(o.ResultListIndex,"record-type format-citation",ep.clientData.hoverPreviewLabelData.FullCitation,true);var n=document.getElementById("externalLinks"+o.ResultListIndex);if(n&&n.innerHTML&&n.innerHTML.length>0){s+='<div class="hover-external-links" data-auto="preview_detail_external_links">'+n.innerHTML+"</div>";}}}s+="</div>";if(ep.isPageRTL()){s=ep.utilities.bidiSanitizeContent(s);}return s;}function m(s,n,t){if(s.ResultListIndex){return i(s.ResultListIndex,"",n,false);}else{if(s.FooterLinks){var o=s.FooterLinks;if(o&&o.length>0&&s.TargetId){for(var p=0;p<o.length;p++){if(o[p].Args==="Citation"||o[p].Text==="Retrieve Item"){var q=jQuery.extend({},o[p]);q.CssClass="";q.Text=n;return c(s.TargetId,q);}}}return null;}else{var r="";if(t){r+='<a href="'+t+"\" data-auto='title_link'>"+n+"<a/>";}else{r=n;}return r;}}}function l(n){var o=n[0];a.each(n,function(p,q){if(p>0){o+="; "+q;}});return o;}function k(n,o){if(!n){return false;}return _.indexOf(n,o)>-1;}function b(u,t){var n="hover-add-folder";var p=ep.clientData.hoverPreviewLabelData.AddToFolder;var r=!t.RecordHasEISExtLink?ep.clientData.hoverPreviewLabelData.AddToFolderTitle:ep.clientData.hoverPreviewLabelData.AddExternalRecToFolder;var s=false;if(t.ResultListIndex){var q=document.getElementById("add_"+t.ResultListIndex);if(q&&q.style.display==="none"){s=true;}}else{s=t.IsInFolder;}if(s){n="hover-remove-folder";if(ep.dialog.isShowAddFolderPopup){p=ep.clientData.hoverPreviewLabelData.AddRemoveToFolder;r=ep.clientData.hoverPreviewLabelData.AddRemoveToFolderTitle;}else{p=ep.clientData.hoverPreviewLabelData.RemoveFromFolder;r=!t.RecordHasEISExtLink?ep.clientData.hoverPreviewLabelData.RemoveFromFolderTitle:ep.clientData.hoverPreviewLabelData.RemoveExternalRecFromFolder;}}var o="";if((window.location.href.indexOf("/folder?")<0)&&(!t.NoteContentType)){if(ep.dialog.isShowAddFolderPopup){o+='<a data-auto="hover_folder_link" class="{cssclass}" id="hover_folder" href="#" onclick="ep.dialog.RecordPreview.showFolderPopup(event, {dataIndex})" title="{titleText}"><span data-auto="hover_folder_icon" class="icon"></span>{text}</a>';}else{o+='<a data-auto="hover_folder_link" class="{cssclass}" id="hover_folder" href="#" onclick="return ep.dialog.RecordPreview.toggleHoverFolderLink(this,{dataIndex},{rlindex},{RecordHasEISExtLink});" title="{titleText}"><span data-auto="hover_folder_icon" class="icon"></span>{text}</a>';o=o.replace(/\{rlindex\}/g,t.ResultListIndex?t.ResultListIndex.toString():"null");}o=o.replace(/\{dataIndex\}/,u.toString());o=o.replace(/\{RecordHasEISExtLink\}/,t.RecordHasEISExtLink);o=o.replace(/\{cssclass\}/,n);o=o.replace(/\{text\}/g,p);o=o.replace(/\{titleText\}/g,r);}else{o+='<span data-auto="hover_remove_folder_icon" class="hover-remove-folder"><span class="icon"></span>';o+=ep.clientData.hoverPreviewLabelData.FolderItem;o+="</span>";o=o.replace(/\{text\}/,p);o=o.replace(/\{titleText\}/,r);}return o;}function c(p,o){var n="<a data-auto='citation_link' href=\"";if(o.DoPostBack===true){n+="javascript";n+=":__doPostBack('";n+=p;n+="','"+o.Args+"');";}else{if(o.Args.indexOf("url=http")>-1){n+=o.Args;n+='" target="_blank';}else{n+=o.Args+'"';}}if(o.CssClass&&o.CssClass.length>0){n+='" class="'+o.CssClass;}n+='">'+o.Text;n+="</a>";return n;}function i(s,p,r,q){var n=document.getElementById("Result_"+s);var o;if(n){if(n.getAttributeNode("onclick")===null){o="<a data-auto='citation_link' href=\""+n.getAttribute("data-href")+'" onclick="'+h(n.getAttributeNode("data-onclick").nodeValue,r,s,q);}else{o="<a data-auto='citation_link' href=\""+n.getAttribute("href")+'" onclick="'+h(n.getAttributeNode("onclick").nodeValue,r,s,q);}o+='" class="'+p+'">'+r+"</a>";}return o;}function h(n,q,r,p){var o=n;if(p){o="__doLinkPostBack('','target~~fulltext||args~~";o+=r;o+="',''); return false;";}return o;}function j(u){var s="";var r=jQuery("#formats"+u);if(r.length){var o=jQuery(r).clone();if(jQuery.trim(o.html())===""){var t=jQuery("#smartlinkft"+u);if(t&&t.length){o.append(t[0].outerHTML);}var p=jQuery("#htmlft"+u);if(p&&p.length){o.append(p[0].outerHTML);}var q=jQuery("#pdfft"+u);if(q&&q.length){o.append(q[0].outerHTML);}var n=jQuery("#epubft"+u);if(n&&n.length){o.append(n[0].outerHTML);}}o.find("[id*='Download']").remove();o.find("[class*='requires-wma']").remove();o.find("[class*='audio-clip']").remove();s+=o.html();}return s;}return{initPreviewHovers:function(r,s){ep.dialog.RecordPreview.isShowFolderLink=r;var q=jQuery('[id^="hoverPreview"]').length;for(var p=0;p<q;p++){var o="hoverPreview"+(p+1);var n=document.getElementById(o);if(n){ep.dialog.HoverPopup.addHover(o,p,e,s);}}},addSelfContainedRecordPreview:function(n,o){if(!g[n.id]){ep.dialog.HoverPopup.addHover(n,n,d,o);}g[n.id]=true;},showFolderPopup:function(r,t){r.preventDefault();var s=t+1;var o=jQuery("#hoverPreview"+s).data("hoverpreviewjson");if(o){var p=false;var q=s?s:"";var n=jQuery("#add_"+q);if(n.length&&n.css("display")!=="none"){p=true;}ep.controller.control.AddToFolderPopup.showAddToFolderPopup(r,{theResultId:q,theIsResultList:true,theIsResultHover:true,theIsToggleIcon:p});}},toggleHoverFolderLink:function(r,s,u,p){var q=s+1;var t=jQuery("#hoverPreview"+q).data("hoverpreviewjson");if(t){var n=r.className==="hover-add-folder";if(u!==null){ep.folder.toggleFolderItem(u,n);}else{if(t){var o=ep.utilities.buildAjaxRequestPath("Folder/SetRouteKeyFolderJson",{Db:t.db,Tag:t.tag,Term:t.term});jQuery.ajax({url:o,async:false,success:function(v){ep.folder.toggleFolderItem(u,n,v);}});}}if(n){r.title=!p?ep.clientData.hoverPreviewLabelData.RemoveFromFolderTitle:ep.clientData.hoverPreviewLabelData.RemoveExternalRecFromFolder;r.innerHTML='<span class="icon" data-auto="hover_folder_icon"></span>'+ep.clientData.hoverPreviewLabelData.RemoveFromFolder;r.className="hover-remove-folder";t.IsInFolder=true;}else{r.title=!p?ep.clientData.hoverPreviewLabelData.AddToFolderTitle:ep.clientData.hoverPreviewLabelData.AddExternalRecToFolder;r.innerHTML='<span class="icon" data-auto="hover_folder_icon"></span>'+ep.clientData.hoverPreviewLabelData.AddToFolder;r.className="hover-add-folder";t.IsInFolder=false;}}return false;}};}();})(jQuery);(function(a){function b(){var i=a("#pubDateRange");if(!i.length){return;}ep.debug("ep.dualSlider.init");var f=a("#filterDateFrom > input"),g=a("#filterDateTo > input"),c=a("#common_DT1_FromYear"),d=a("#common_DT1_ToYear"),h=parseInt(f.val(),10)||ep.clientData.dateSliderData.FromYear,j=parseInt(g.val(),10)||ep.clientData.dateSliderData.ToYear;if(!i.length){return;}i.slider({range:true,min:h,max:j,values:[h,j]});i.bind("slide",function(l,m){f.val(m.values[0]);c.val(m.values[0]);g.val(m.values[1]);d.val(m.values[1]);a("#resultsLimiterContent").trigger("click");});function e(m){var l=a(m.target);if(l.val()<f.val()){l.val(f.val());}else{if(l.val()>g.val()){l.val(g.val());}}c.val(f.val());d.val(g.val());i.slider("values",[f.val(),g.val()]);i.trigger("change");}function k(n){var m=a(n.target);var l=n.keyCode;if(l===a.ui.keyCode.UP){m.val(parseInt(m.val(),10)+1);e(n);}else{if(l===a.ui.keyCode.DOWN){m.val(parseInt(m.val(),10)-1);e(n);}}}f.blur(e);g.blur(e);f.keydown(k);g.keydown(k);}a(b);ep.dualSlider={init:b};})(jQuery);(function(a){var b;function c(e,d){ep.debug("ep.controller.control.ClusterControl.recordClusterPanelState");var f=ep.utilities.buildAjaxRequestPath("Panel/UpdateCluster");a.ajax({type:"post",url:f,data:{theCluster:e,isExpanded:d}});}a(document).ready(function(){ep.debug("ep.controller.control.ClusterControl.onDomLoaded");ep.getInstance("ep.utilities");b=a("#ClusterContainer");if(b.length){b.find(".cluster-more-link").each(function(e,d){ep.dialog.ToggledPopup.addDialog(d,a(d).parents("ul").next()[0],null,200,"Close",null,true);});}else{b=a("#multiSelectClusterContainer");}if(b.length){b.find(".collapse-toggle").each(function(){a(this).bind("toggled",function(e,f){var d=a(this).children("input");if(!d.length){d=a(this).parent().find("input[name='_clusterId_']").first();}c(d.val(),a(this).hasClass("active"));});});}});})(jQuery);(function(a){var b;var c;function d(e){var f=ep.utilities.buildAjaxRequestPath("Panel/UpdateDocType");a.ajax({type:"post",url:f,data:{theIsExpanded:e}});}a(document).ready(function(){ep.getInstance("ep.utilities");b=a.extend(a("#DocTypeContainer"),a("#multiSelectDocType"));if(a("#DocTypeContainer").length===0&&a("#multiSelectDocType").length===0){return;}c=a("#moreDocumentTypesLink")[0];if(c){var e=function(g){return g.innerHTML.replace("none","block");};var f=a("#doc-type-overflow")[0];ep.dialog.ToggledPopup.addDialog(c,f,e,250,"a");}b.find(".panel_toggle, .panel_toggle_active, .collapse-toggle").each(function(h,g){a(g).bind("CollapsiblePanel_toggled",function(i,j){d(j.isExpanded);});a(g).bind("toggled",function(i,j){d(a(this).hasClass("active"));});});});})(jQuery);ep.register("ep.controller.control.ImageQuickView",function(a){var d=function(i){ep.debug("ep.controller.control.ImageQuickView.onIQVLinkClick");i.preventDefault();var h=a(i.target).data("iqvargs");if(h){b(ep.controller.control.ImageQuickView.thumbnailType,h);}};function g(i){ep.debug("ep.controller.control.ImageQuickView.setEvents");var h=a("a[id^='linkQuikView']");if(h.length){if(i){h.unbind();}else{h.click(d);}}}function f(i,j){ep.debug("ep.controller.control.ImageQuickView.setAjaxActivity");var h=a("#ajaxActivity_"+j);if(h.length){h.css({display:(i)?"inline":"none"});}}function b(l,i){ep.debug("ep.controller.control.ImageQuickView.getThumbnails");var j=i.itemId;var h=("tContainer2_"+j);f(true,j);if(a("#"+h).is(":empty")){var k={theThumbnailType:l,SearchTerm:i.searchTerm,DB:i.db,ParentUI:i.an,Tag:i.tag,theSearchData:i.searchData};var m=ep.utilities.buildAjaxRequestPath("ImageQuickView/GetThumbnails");a.ajax({type:"POST",url:m,data:k,context:this,success:function(n){e(h,n);}});}else{e(h);}}function e(m,n){ep.debug("ep.controller.control.ImageQuickView.processThumbnailData");var h=a("#"+m);var i=m.split("_")[1];var l=a("#linkQuikView11_"+i);var k=a("#linkQuikView21_"+i);var j=a("#linkQuikView22_"+i);if(h.is(":visible")){h.hide();l.css({display:"inline"});k.css({display:"none"});j.parent().css({display:"none"});}else{h.show();l.css({display:"none"});k.css({display:"inline"});j.parent().css({display:"inline"});}if(h.is(":empty")){h.html(n);}f(false,i);}function c(){ep.debug("ep.controller.control.ImageQuickView.Initialize");ep.getInstance("ep.utilities");g(false);a(window).unload(a.proxy(function(){g(true);},this));}ep.domLoad(c);}(jQuery));var aNamespace=ep.register("ep.controller.control.RelatedInfoControl");ep.controller.control.RelatedInfoControl.resolvePendingExternalItems=function(){ep.debug("ep.controller.control.RelatedInfoControl.resolvePendingExternalItems");var h;var b=ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject();if(b&&b.has_external_items()){var c=b.get_external_items();for(h=0;h<c.length;h++){var g=c[h].get_element().find(".panel_toggle").first();jQuery(g).on("click",ep.controller.control.RelatedInfoControl.onPanelExpand);}}if(b&&b.has_pending_items()){var d=[];var e=b.get_pending_items();for(h=0;h<e.length;h++){d.push(e[h].get_itemID());}var a=ep.utilities.replaceEPCommand("resolvependingsearchtabs");var f=jQuery.ajax({url:a,type:"POST",data:{TabIDs:d}}).done(function(i){ep.controller.control.RelatedInfoControl.onPendingExternalItemsResolved(i,e);});}};ep.controller.control.RelatedInfoControl.onPendingExternalItemsResolved=function(f,e){ep.debug("ep.controller.control.RelatedInfoControl.onPendingExternalItemsResolved");if(f===null){return;}var b=f.split(",");if(b&&b.length>0){for(var d=0;d<b.length;d++){var c=parseInt(b[d],10);if(c===1){e[d].set_itemState("Normal");}else{if(c===0){e[d].set_itemState("Disabled");}}}var a=ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject();if(a.has_pending_items()){window.setTimeout(ep.controller.control.RelatedInfoControl.resolvePendingExternalItems,0);}}};ep.controller.control.RelatedInfoControl.showExternalSourcePreview=function(b){ep.debug("ep.controller.control.RelatedInfoControl.showExternalSourcePreview");var a=document.getElementById(b);return a?a.innerHTML:null;};ep.controller.control.RelatedInfoControl.onPanelExpand=function(f){ep.debug("ep.controller.control.RelatedInfoControl.onPanelExpand");var a=jQuery(f.target).closest('div[id$="externalItem"]');var d=a.find("h3.panel_toggle").first();jQuery(d).off("click",ep.controller.control.RelatedInfoControl.onPanelExpand);var c=jQuery("#__sid").val();var e=jQuery("#__vid").val();var b=a.find('input[name="externalitemid"]').first().val();ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearch(b,a);};ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject=function(){ep.debug("ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject");var a=jQuery("#relatedInfoControl");if(a.length&&a.children().get(0)){return new EPRelatedInfoExternalBehavior(a.children().get(0));}return null;};ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearch=function(d,c){ep.debug("ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearch");var a=ep.utilities.replaceEPCommand("performrelatedinfoexternalsearch");var b=jQuery.ajax({url:a,type:"POST",data:{GroupName:d},dataType:"xml"}).done(function(e){ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearchComplete(e,c);});};ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearchComplete=function(o,n){ep.debug("ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearchComplete");var l=o;if(l===null){return;}var d=ep.utilities.selectSingleNode(l,"EPResponse/ControlHtml");var c=ep.utilities.getXmlElementValue(d);if(c===null){c="";}var k=ep.utilities.selectSingleNode(l,"EPResponse/ShowFindMoreLink");var j=ep.utilities.getXmlElementValue(k);if(j===null){j="false";}var b;if(n){var a=jQuery(n).find(".external-source-content");if(a.length){b=jQuery(a).get(0);}}if(b){b.innerHTML=c;var e=getElementByClientId("lnkFindMore",n);if(e){e.className=j==="true"?"find-more":"find-more-hidden";}var h=jQuery(b).find(".preview-hover");for(var m=0;m<h.length;m++){var g=h.get(m);var f=g.id+"-content";ep.dialog.HoverPopup.addHover(g.id,f,ep.controller.control.RelatedInfoControl.showExternalSourcePreview,570);}}};ep.domLoad(ep.controller.control.RelatedInfoControl.resolvePendingExternalItems);ep.registerInstance("ep.controller.control.LimitYourResultsControl","ep.base.Controller",{IS_CHANGED:0,onDomLoad:function(){ep.debug("ep.controller.control.LimitYourResultsControl.onLoad");var f=jQuery("#resultsLimiterContent");if(f.length){jQuery("#pubDateRange").live("slidechange",jQuery.proxy(this.onSliderChanged,this));var d=f.find('input[type="checkbox"]');d.click(jQuery.proxy(this.enableUpdateResultsButton,this));var e=f.find('input[id$="HasSliderBeenSet"]').val();if(e==="1"){var g=ep.clientData.dateSliderData;if(g){this.setPubDateLimiterFields(g.FromYear,g.ToYear);}}}ep.getInstance("ep.utilities");var a=jQuery("#resultsLimiterControl");var b=this;if(a.length){var c=a.find(".collapse-toggle");jQuery(c).bind("toggled",function(h,i){b.recordResultLimiterPanelState(jQuery(a).hasClass("active"));});}},enableUpdateResultsButton:function(f){ep.debug("ep.controller.control.LimitYourResultsControl.enableUpdateResultsButton");var a=jQuery("#resultsLimiterContent");var c=a.find('input[id$="isSliderChanged"]');var d=a.find('input[id$="UpdateButton"]').first();var e=f.target;var b=jQuery(e);if(d.is(":disabled")&&(c.val()==="1"||(e.tagName==="INPUT"&&b.attr("type")==="checkbox"))){d.removeClass("buttonDisabled");d.prop("disabled",false);this.IS_CHANGED=1;}},onSliderChanged:function(h,g){ep.debug("ep.controller.control.LimitYourResultsControl.onSliderChanged");var a=jQuery("#resultsLimiterContent");var e=parseInt(a.find('input[id$="MinDateOrig"]').val(),10);var d=parseInt(a.find('input[id$="MaxDateOrig"]').val(),10);var c=a.find('input[id$="isSliderChanged"]');var b=parseInt(jQuery("#common_DT1_FromYear").val());var f=parseInt(jQuery("#common_DT1_ToYear").val());if(b<g.values[0]){g.values[0]=b;}if(f>g.values[1]){g.values[1]=f;}if(g.values[0]!==e||g.values[1]!==d){c.val("1");a.trigger("ep_DualSlider_sliderChanged",g);this.enableUpdateResultsButton(h);}else{c.val("0");}this.setPubDateLimiterFields(jQuery("#common_DT1_FromYear").val(),jQuery("#common_DT1_ToYear").val());},setPubDateLimiterFields:function(a,b){ep.debug("ep.controller.control.LimitYourResultsControl.setPubDateLimiterFields");jQuery("#common_DT1_FromYear").val(a);jQuery("#common_DT1_ToYear").val(b);},recordResultLimiterPanelState:function(a){ep.debug("ep.controller.control.LimitYourResultsControl.recordResultLimiterPanelState");var b=ep.utilities.buildAjaxRequestPath("Panel/UpdateResultLimiter");jQuery.ajax({type:"post",url:b,data:{theIsExpanded:a}});}});var aNamespace=ep.register("ep.controller.control.FolderItemsControl");ep.controller.control.FolderItemsControl.updateFolderCount=function(b){ep.debug("ep/controller/control/folderitemscontrol.js -> updateFolderCount");var a=window.isToolbarOnParent&&window.parent?window.parent:window;a.ep.folder.updateToolbarFolderCount(b);};ep.controller.control.FolderItemsControl.folderItemsAddRemove=function(b,f,g,e,c,d){ep.debug("ep/controller/control/folderitemscontrol.js -> folderItemsAddRemove");var a={DbName:b,UITag:f,UITerm:g,Title:e};EPWebServices.FolderWebService.FolderItemsAddRemove(ep.controller.control.FolderItemsControl._getSessionParams(),a,c,d,ep.controller.control.FolderItemsControl.onSuccessfulAddRemove);ep.controller.control.FolderItemsControl.folderItemsToggleResultList(a,c);ep.controller.control.FolderItemsControl.updateFolderCount(c);return false;};ep.controller.control.FolderItemsControl.folderItemsToggleResultList=function(h,i){ep.debug("ep/controller/control/folderitemscontrol.js -> folderItemsToggleResultList");var a=1;var c=$("#add_"+a);while(c.length&&a<101){c=$("#add_"+a).data("folder");if(typeof c==="object"){c=JSON.stringify(c);}var d=ep.folder.escapeAndParseJson(c);var b=d.db;var e=d.uiTag;var f=d.uiTerm;if(h.DbName===b&&h.UITag===e&&h.UITerm.toString()===f&&h.Title){var g="";if(jQuery("#added_"+a).length){if(i){jQuery("#added_"+a).css("display",g);$("add_"+a).hide();}else{$("added_"+a).hide();jQuery("#add_"+a).css("display",g);}}else{ep.controller.control.FolderItemsControl.setCitationFolder(i);}break;}a++;}return false;};ep.controller.control.FolderItemsControl.setCitationFolder=function(e){ep.debug("ep/controller/control/folderitemscontrol.js -> setCitationFolder");var a=jQuery("#AddToFolderClientIDs").val().split(",");var d=0;var c=7;var b="";if(e){do{if(d%2){b="none";}else{b="inline";}if("#"+jQuery(a[d]).length){jQuery("#"+a[d]).css("display",b);}d=d+1;}while(d<c);}else{do{if(d%2){b="inline";}else{b="none";}if(document.getElementById(a[d])){document.getElementById(a[d]).style.display=b;}d=d+1;}while(d<c);}};ep.controller.control.FolderItemsControl.onSuccessfulAddRemove=function(b){ep.debug("ep/controller/control/folderitemscontrol.js -> onSuccessfulAddRemove");var a=jQuery("#folderItemsContainerControl");if(a.length){a.html(b);}};ep.controller.control.FolderItemsControl._getSessionParams=function(){ep.debug("ep/controller/control/folderitemscontrol.js -> _getSessionParams");return{sessionID:jQuery("#__sid").val(),sessionVId:jQuery("#__vid").val()};};ep.registerClass("ep.base.ResultListController",{initialize:function($super,a){$super(a);},_domLoaded:function($super){this.initializeControls();$super();},_windowLoaded:function($super){_.defer(ep.loadImages);$super();},initializeControls:function(){if(jQuery("#ClusterContainer").length){ep.require("ep/controller/control/ClusterControl.js");}if(jQuery("a[data-audiosummarydb]").length){ep.require("ep/controller/control/audiosummary.js");}var a=jQuery("a[id^='linkQuikView']");if(a.length){ep.getInstance({epId:"ep.controller.control.ImageQuickView",thumbnailType:"THUMB_SMALL"});}}},"ep.base.PageController");(function(a){a.widget("ui.simpleaccordion",{options:{tabOpenCallbacks:{},tabCloseCallbacks:{},tabOtherCloseCallbacks:{}},_create:function(){var b=this;_.bindAll.apply(_,[this].concat(_.functions(this)));this.tabs=[];this.$tabs=this.element.find("[data-simple-accordion-tab]");this.$contents=this.element.find("[data-simple-accordion-content]");a(this.$tabs).each(_.bind(function(e,d){var c=a(d),f={isActive:false,$tab:c,$content:this.getContentElement(c),hasBeenActivated:false};this.tabs.push(f);c.click(_.bind(function(g){f.isActive=!f.isActive;f.$tab.toggleClass("active");f.$content.toggle();if(f.isActive){b.executeCallbacks("tabOpenCallbacks",f);}else{b.executeCallbacks("tabCloseCallbacks",f);}a.each(this.tabs,function(h,i){if(f!==this&&this.isActive){b.executeCallbacks("tabCloseCallbacks",i);b.executeCallbacks("tabOtherCloseCallbacks",i);this.isActive=false;this.$tab.removeClass("active");this.$content.hide();}});f.hasBeenActivated=true;},this));},this));},getContentElement:function(b){return this.$contents.filter('[data-simple-accordion-content="'+b.data("simpleAccordionTab")+'"]');},executeCallbacks:function(b,c){a.each(this.options[b],_.bind(function(e,d){if(c.$tab.data("simpleAccordionTab")===parseInt(e,10)){d(c,this.element);}},this));}});})(jQuery);(function(a){ep.require("_layout2/alertmodaldialog.css",function(){a(function(){var d,g,c,b,f,e;a(document).on("click",'input[id$="submitAlert"]',function(i){h();return false;});a(document).on("click",'input[id$="cancelAlert"]',function(i){a(".ui-dialog-titlebar-close").trigger("click");return false;});a(document).on("keypress","#email",function(i){if(i.which===13){h();return false;}});a(document).on("keypress",'input[id$="submitAlert"]',function(i){if(i.which===13){h();return false;}});function h(){var j=a("#alertContent").validate({rules:{email:{required:true,email:true}},messages:{email:{required:ep.messages.verify_email,email:ep.messages.verify_email}},onsubmit:false});if(!j.form()){return false;}c=a("#alertVerificationMessage");b=a("#alertFrequency");f=a("#serverError");e=a("#email");d=a('input[id$="cancelAlert"]');a(".epmodal.ui-dialog").css("width","800px");if(f.attr("class")==="error"){f.removeClass();f.addClass("hidden");}var i=jQuery("#alertWrapper").data("alertdata");g=ep.utilities.buildAjaxRequestPath("Alert/SendAlertEmail")+"&theAlertName="+i.theAlertName+"&theAlertType="+i.theAlertType+"&theAlertSearchString="+i.theAlertSearchString+"&theEmailAddress=";a.ajax({url:g+e.val()+"&theAlertFrequency="+b.val(),success:function(l){if(l.IsError){f.removeClass();f.addClass("error");f.html(l.Message);}else{var k=a(l).find(".email-alert");a("#headerPersonalized").remove();k.find("h2").remove();k.find("button").remove();a(".alert-list-wrapper").first().html(k);a("#submitAlert").hide();d.val(ep.messages.ok);d.addClass("primary-action");}}});}});});})(jQuery);jQuery.fn.absolutize=function(){return this.each(function(){var a=jQuery(this);if(a.css("position")==="absolute"){return a;}var d=a.offset();var e=d.top;var c=d.left;var f=a[0].clientWidth;var b=a[0].clientHeight;a._originalLeft=c-parseFloat(a.css("left")||0);a._originalTop=e-parseFloat(a.css("top")||0);a._originalWidth=a.css("width");a._originalHeight=a.css("height");a.css("position","absolute");a.css("top",e+"px");a.css("left",c+"px");a.css("width",f+"px");a.css("height",b+"px");return a;});};(function(a){ep.registerClass("ep.base.ModalDialogController",{command:null,$coverScreen:null,previousAspForm:null,display:null,content:null,$loadDialog:null,showCloseButton:true,showModalDuration:0.5,showCoverDuration:0.5,dialogClass:null,initialize:function($super,b){$super(b);},show:function(){if(!this.previousAspForm&&window.theForm){this.previousAspForm=window.theForm;}this.displayLoadDialog();if(!this.$coverScreen){this.$coverScreen=a("#modal-screen");}if(!this.$coverScreen.is(":visible")){this._layoutScreen();this.$coverScreen.fadeTo(this.showCoverDuration,this.screenOpacity||0.5);}},_domloaded:function(){this.onLoad();},initDisplay:function(){var h;var g,b;var d=this.dialogClass?"modal-dialog "+this.dialogClass:"modal-dialog ";if(this.showCloseButton){h=a("<div waiRole='dialog' class='"+d+"'><span tabIndex=0 class='ui-icon ui-icon-closethick'>Close</span></div>").get(0);}else{h=a("<div waiRole='dialog' class='"+d+"'>").get(0);}g=document.body.appendChild(h);if(this.cssClass){a(g).addClass(this.cssClass);}a(g).css({display:"none"});var e=a.proxy(function(j){this.handleCloseKeyPress(j);},this);b=a(".modal-dialog .ui-icon-closethick");if(this.showCloseButton){b.on("click",a.proxy(this.hide,this));}b.on("keydown",e);var f=a("<div>").get(0);f.id="modal-content";f.className=this.containerId="modal-content";if(this.content){a(f).append(this.content);}a(g).append(f);var c=a("<span tabIndex=0 class='modal-tab-end'>").html(" ");a(g).append(c);var i=a.proxy(function(){this.display.container.firstChild.focus();},this);c.on("focus",i);this.display={container:g,closeElement:this.showCloseButton?b.get(0):null,contentElement:f};this.container=this.display.contentElement;},displayLoadDialog:function(c){if(!c){c="Loading ...";}if(!this.$loadDialog){this.$loadDialog=a("<div tabIndex=0 class='modal-loading'>");this.$loadDialog.css({position:"absolute"});}this.$loadDialog.html(c);a(document.body).append(this.$loadDialog);this.$loadDialog.css({top:"-1000px",left:"0px"});var b=a.proxy(function(){try{this.$loadDialog.focus();}catch(d){}},this);b();this.$loadDialog.effect("pulsate",{times:30},"normal");},_layoutScreen:function(){if(!this.$coverScreen){this.$coverScreen=a("#modal-screen");}if(!this.$coverScreen.length){this.$coverScreen=a("<div id='modal-screen' class='modal-screen'>");this.$coverScreen.hide();}this.$coverScreen.insertBefore(this.display.container);var e={width:a(window).width(),height:a(window).height()};var c={height:document.documentElement.scrollHeight,width:document.documentElement.scrollWidth};c.height=c.height>e.height?c.height:e.height;c.width=c.width>e.width?c.width:e.width;var d={left:a(window).scrollLeft(),top:a(window).scrollTop()};this.$coverScreen.css({top:"0",left:"0px",height:c.height+"px",width:c.width+"px"});if(this.$loadDialog){var b={width:this.$loadDialog.outerWidth(),height:this.$loadDialog.outerHeight()};this.$loadDialog.css({top:(d.top+e.height/2-b.height/2)+"px",left:(d.left+e.width/2-b.width/2)+"px"});}},handleCloseKeyPress:function(b){if(b.keyCode===13){this.hide();}else{if(b.keyCode===9&&b.shiftKey){b.preventDefault();}}},hide:function(){if(this.display){var b=a.proxy(function(){if(this.childForms&&this.childForms.length){a.each(this.childForms,function(d,c){c.reset();});}},this);a(this.display.container).fadeOut("normal",b);if(_.isFunction(this.onHide)){this.onHide();}this.$coverScreen.dialog=this;this._hideCoverScreen();window.theForm=this.previousAspForm||null;}},_hideCoverScreen:function(){this.$coverScreen.fadeOut("normal",this._onAfterHide);},_onAfterHide:function(){a(".modal-dialog, .modal-loading, .modal-screen").each(function(c,b){a(b).remove();});this.display=this.$coverScreen=this.content=null;},_onunloaded:function($super){$super();a(".modal-dialog, .modal-loading, .modal-screen").each(function(c,b){a(b).remove();});this.display=this.$coverScreen=this.content=null;},render:function(){this.layout();a(this.display.container).fadeIn(this.showModalDuration,this.renderComplete.bind(this));this.childForms=a(this.display.contentElement).find("form");if(window.theForm&&this.childForms.length>0){window.theForm=this.childForms[0];}this.childForms.each(a.proxy(function(c,b){b.dialog=this;if(_.isFunction(this.onsubmit)){a(b).on("submit",this.onsubmit);}},this));},layout:function(){this.$loadDialog.stop(true,true).fadeOut("normal");if(this.display){a(this.display.container).css({position:"absolute",top:"-10000px",left:"0px",display:"block"});var c={width:a(this.display.container).outerWidth(),height:a(this.display.container).outerHeight()};var b={width:a(window).outerWidth(),height:a(window).outerHeight()};var d={left:a(window).scrollLeft(),top:a(window).scrollTop()};a(this.display.container).hide();var e=d.top+10;if(c.height<b.height){e=d.top+b.height/2-c.height/2;}a(this.display.container).css({top:e+"px",left:(d.left+(b.width||document.body.clientWidth)/2-c.width/2)+"px"});if(this.showCloseButton){a(this.display.closeElement).absolutize();}}},renderComplete:function(){this.focusTitle();if(this.$loadDialog){this.$loadDialog.fadeOut("fast");}if(_.isFunction(this.onModalRender)){this.onModalRender();}},focusTitle:function(){if(_.isString(this.titleElement)){var b=a(this.display.contentElement).find(this.titleElement).get(0);if(b){b.tabIndex=0;b.focus();}}},onUpdate:function(){this.render();}},"ep.base.ModuleController");})(jQuery);ep.registerClass("ep.base.ModalPanelController",{showCloseButton:true,panelElement:null,panel:null,panelProps:null,parentProps:null,showModalDuration:0,dialogClass:"modal-panel",modalPanel:null,checkboxes:[],defaultValues:{},isSubmit:null,isValidate:true,command:null,coverScreen:{},previousAspForm:null,display:null,content:null,showCoverDuration:500,screenOpacity:0.5,clickedEl:null,onDomLoad:function(){this.panel=jQuery("#"+this.panelElement);this.setPanelEvents();this.storeState();},storeState:function(){this.checkboxes=this.panel.find('input[type="checkbox"]').attr("autocomplete","off");this.defaultValues={};this.checkboxes.each(jQuery.proxy(function(b,a){this.defaultValues[a.id]={checked:a.checked,disabled:a.disabled};},this));},revertState:function(){this.checkboxes.each(jQuery.proxy(function(c,a){var b=this.defaultValues[a.id];a.checked=b.checked;a.disabled=b.disabled;},this));},setPanelEvents:function(){if(this.panel.length){this.panel.bind("click.modalpanel",jQuery.proxy(this.columnPanelClickHandler,this));}},setPanelPosition:function(){if(!this.panelProps){this.initPanelProps();}var a=this.panel.offset();this.panelProps.left=a.left;this.panelProps.top=a.top;if(this.parentProps){this.panelProps.left-=this.parentProps.paddingLeft;}},initPanelProps:function(){this.panelProps={top:null,left:null,width:this.panel.width(),cols:1,colWidth:this.panel.width()};var a=this.panel.parents("#column1, #column2").first();if(a.length){this.parentProps={paddingLeft:parseFloat(a.css("padding-left")),paddingRight:parseFloat(a.css("padding-right"))};this.panelProps.width=this.panelProps.colWidth+=(this.parentProps.paddingLeft+this.parentProps.paddingRight+40);}},setPanelSize:function(){this.panelProps.width=this.panelProps.colWidth*this.panelProps.cols;},createPlaceholder:function(){this.placeholder=jQuery("<div>");this.placeholder.css("height",this.panel.height()+"px");this.panel.before(this.placeholder);},restorePanel:function(){if(this.placeholder&&this.placeholder.length){if(this.panel.parent().length){this.panel.remove();}this.placeholder.after(this.panel);this.placeholder.remove();this.panel.unbind(".modalpanel");this.setPanelEvents();this.placeholder=null;}},movePanel:function(){this.setPanelPosition();this.setPanelSize();this.createPlaceholder();this.panel.unbind(".modalpanel");this.content=this.panel;this.showModal();},showModal:function(){window.setTimeout(_.bind(function(){function a(d){var c=jQuery(window).scrollTop();var b=c+jQuery(window).height();var f=jQuery(d).offset().top;var e=f+jQuery(d).height();return((e<=b)&&(f>=c));}this.initDisplay();this.render();this.show();if(this.clickedEl){if(!a(this.clickedEl)){this.clickedEl.scrollIntoView();}}},this),0);},render:function(){this.modalPanel=jQuery("#modal-content");this.toggleFormControls(true);this.layout();this.modalPanel.find(".collapse-toggle").data("disableexpandcollapse","true");this.display.container.fadeIn(this.showModalDuration,jQuery.proxy(this.renderComplete,this));this.childForms=this.display.contentElement.find("form");if(window.theForm&&this.childForms.length>0){theForm=this.childForms.get(0);}this.childForms.each(jQuery.proxy(function(b,a){if(jQuery.isFunction(this.onSubmit)){jQuery(a).bind("submit.modalpanel",this.onSubmit);}},this));},onModalRender:function(){this.setModalEvents();},setModalEvents:function(){if(this.modalPanel.length){this.modalPanel.unbind(".modalpanel");this.modalPanel.bind("click.modalpanel",jQuery.proxy(this.modalPanelClickHandler,this));}},hide:function(){if(this.display){this.display.container.fadeOut(this.showModalDuration,jQuery.proxy(this._resetFormElements,this));this._hideCoverScreen();theForm=this.previousAspForm||null;}this.modalPanel=null;this.toggleFormControls(false);this.restorePanel();if(this.isSubmit!==true){this.revertState();}},_resetFormElements:function(){if(this.childForms&&this.childForms.length){this.childForms.each(function(b,a){a.reset();a=null;});}},_hideCoverScreen:function(){if(this.isSubmit!==true){this.coverScreen.fadeOut(this.showCoverDuration,this._onAfterHide);}},layout:function(){if(this.display){if(this.panelProps.top){this.display.container.css({top:this.panelProps.top+"px"});}if(this.panelProps.left){this.display.container.css({left:this.panelProps.left+"px"});}if(this.panelProps.width){this.display.container.css({width:this.panelProps.width+"px"});}if(this.panelProps.height){this.display.container.css({height:this.panelProps.height+"px"});}}},onUpdate:function(){this.setPanelSize();this.render();},columnPanelClickHandler:function(b){var a=jQuery(b.target);if(a.is("input")&&!a.is("[type='submit']")&&!a.is("[type='button']")){this.clickedEl=a.get(0);this.movePanel();}},modalPanelClickHandler:function(b){ep.debug("modalpanelcontroller : modalPanelClickHandler()");var a=jQuery(b.target);this.isSubmit=false;if(a.is("input[type='submit'], input[type='button']")){if(this.isValidate){this.isSubmit=true;this.hide();}}if(a.is("a.panelCancel")){this.hide();}},toggleFormControls:function(a){ep.debug("modalpanelcontroller : toggleFormControls()");if(a){this.modalPanel.find("input[type='submit'], input[type='button']").each(jQuery.proxy(function(c,b){b.disabled=null;this.insertCancel(b);},this));}else{if(this.isSubmit!==true){this.panel.find("input[type='submit'], input[type='button']").attr("disabled","disabled").trigger("enabledStateChange",[true]);}this.panel.find(".modalOnly, .panelCancel").remove();}},insertCancel:function(b){ep.debug("modalpanelcontroller : insertCancel()");var a=jQuery("<a data-auto='cancel_link'>").addClass("panelCancel").text(ep.messages.cancel);jQuery(b).after(a);},show:function(){if(!this.previousAspForm&&window.theForm){this.previousAspForm=theForm;}this._layoutScreen();this.coverScreen.fadeTo(this.showCoverDuration,this.screenOpacity);},initDisplay:function(){var a,c=jQuery("<div>").attr("waiRole","dialog").addClass("modal-dialog").hide();jQuery("body").append(c);if(this.dialogClass){c.addClass(this.dialogClass);}if(this.showCloseButton){a=jQuery("<span>").prop("tabindex",0).addClass("ui-icon ui-icon-closethick");a.html("</span><span>Close</span>");a.bind("click.modalpanel",jQuery.proxy(this.hide,this));a.bind("keydown.modalpanel",jQuery.proxy(this.handleCloseKeyPress,this));c.append(a);}this.containerId="modal-content";var b=jQuery("<div>").attr("id",this.containerId).addClass(this.containerId);if(this.content&&this.content.length){b.append(this.content);}c.append(b);var d=jQuery("<span>").prop("tabindex",0).addClass("modal-tab-end").text(" ");c.append(d);d.bind("focus.modalpanel",jQuery.proxy(this.tabEndHandler,this));this.display={container:c,closeElement:this.showCloseButton?a:null,contentElement:b};this.container=this.display.contentElement;},_layoutScreen:function(){if(!this.coverScreen){this.coverScreen=jQuery("#modal-screen");}if(!this.coverScreen.length){this.coverScreen=jQuery("<div>").attr("id","modal-screen").addClass("modal-screen").css("z-index",9000).hide();}this.display.container.before(this.coverScreen);var b={height:jQuery(window).height(),width:jQuery(window).width()};var a={height:jQuery(document).height(),width:jQuery(document).width()};a.height=a.height>b.height?a.height:b.height;a.width=a.width>b.width?a.width:b.width;this.coverScreen.css({top:"0",left:"0px",height:a.height+"px",width:a.width+"px"});},handleCloseKeyPress:function(a){if(a.which===jQuery.ui.keyCode.ENTER){this.hide();}else{if(a.which===jQuery.ui.keyCode.ENTER&&a.shiftKey){a.preventDefault();}}},tabEndHandler:function(){this.display.container.find(":tabbable").first().focus();},_onAfterHide:function(){if(this.trigger){this.trigger.focus();}jQuery(".modal-dialog, .modal-loading, .modal-screen").remove();this.display=this.content=null;},renderComplete:function(){if(_.isFunction(this.onModalRender)){this.onModalRender();}}},"ep.base.ModuleController");(function(a){ep.require("spinner/spin.min.js",function(){ep.registerClass("ep.base.SelectMultipleController",{panelElement:null,panel:null,command:null,coverScreen:null,modalPanel:null,modalCheckboxes:null,modalCbAll:null,modalCbHidden:null,checkboxName:"",modalWindowHeight:null,onDomLoad:function(){this.panel=jQuery("#"+this.panelElement);this.bindEvents();},initialize:function($super,b){$super(b);},bindEvents:function(){this.panel.find(".limControl, .limCaption>a").click(a.proxy(this.selectLimiters,this));this.panel.find("a.evt-select-mulitple").click(a.proxy(this.showModal,this));this.checkboxes=this.panel.find('input[type="checkbox"]').attr("autocomplete","off");this.checkboxName=this.checkboxes.first().attr("name");},selectLimiters:function(c){var f=a(c.currentTarget);this.showLoading();if(f.is("input.limControl")){var e=f.data("url");var d=(f.is(":checked"))?e.checked:e.unchecked;window.location=d;}else{var b=f.parents("li").find(".limControl");b.prop("checked",true);c.preventDefault();c.stopPropagation();window.location=f.attr("href");}},showLoading:function(){this._layoutScreen();this.coverScreen.fadeTo(200,0.5);this.loadingMessage.show();},_layoutScreen:function(){if(!this.coverScreen){this.coverScreen=a("#modal-screen");}if(!this.coverScreen.length){this.coverScreen=a("<div>").attr("id","modal-screen").addClass("ui-widget-overlay").css("z-index",9000).hide();}a("body").append(this.coverScreen);var c={height:jQuery(window).height(),width:jQuery(window).width()};var b={height:jQuery(document).height(),width:jQuery(document).width()};b.height=b.height>c.height?b.height:c.height;b.width=b.width>c.width?b.width:c.width;this.coverScreen.css({top:"0",left:"0px",height:b.height+"px",width:b.width+"px"});if(!this.loadingMessage){this.loadingMessage=a("#modal-loading");}if(!this.loadingMessage.length){this.loadingMessage=a("<div>").attr({id:"modal-loading",tabIndex:"0","data-auto":"spinner"}).hide();var d=a("<div>").addClass("container").append("<span>Updating...</span>");var e={lines:9,length:4,width:2,radius:2,corners:1,rotate:13,direction:1,color:"#000",speed:0.8,trail:65,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000,top:"0px",left:"auto"};var f=new Spinner(e).spin(d.get(0));this.loadingMessage.append(d);}a("body").append(this.loadingMessage);this.loadingMessage.addClass("modal-loading").css({position:"fixed",top:((c.height/2)-(this.loadingMessage.outerHeight()/2))+"px",left:((c.width/2)-(this.loadingMessage.outerWidth()/2))+"px"});},showModal:function(b){b.preventDefault();b.stopPropagation();var c=a(b.target);c.epmodal({dataUrl:ep.utilities.replaceEPCommand(this.command+"/ExpandedPanel"),sourceElement:c,dialogClass:"fixed",data:{panelId:this.panelElement},onload:a.proxy(this.onModalLoad,this)});},onModalLoad:function(d){var b=a.proxy(function(e){this.modalPanel.find(e).addClass("disabled");},this);var c=a.proxy(function(e){this.modalPanel.find(e).removeClass("disabled");},this);this.modalPanel=a((d)?d.options.container:"#modal");this.storeModalState();this.modalPanel.find(".evt-update-btn").removeAttr("onclick").on("click",a.proxy(this.formSubmit,this));this.modalPanel.find(".evt-cancel-btn").removeAttr("onclick").bind("click",a.proxy(this.hideModal,this));this.modalPanel.find('input[type="checkbox"]').on("click",a.proxy(this.checkboxHandler,this));this.modalPanel.find("a.panelSortHits").on("click",a.proxy(this.sortByHits,this));this.modalPanel.find("a.panelSortName").on("click",a.proxy(this.sortByName,this));this.modalPanel.find(".limCaption>a").on("click",a.proxy(this.selectModalLimiter,this));if(a(".tbody").height()>a(".modal-content").height()){this.modalPanel.find(".evt-up-btn").removeAttr("onclick").show().on("click",a.proxy(this.scrollUp,this));this.modalPanel.find(".evt-down-btn").removeAttr("onclick").show().on("click",a.proxy(this.scrollDown,this));this.modalWindowHeight=Math.round(7*a(".modal-content").height()/8);ep.require("jquery/plugins/jquery.ba-throttle-debounce.js",a.proxy(function(){a(".modal-content").scroll(a.debounce(150,function(){if(!a(".modal-content").scrollTop()){b(".evt-up-btn");c(".evt-down-btn");}else{c(".evt-up-btn");}if((a(".modal-content").scrollTop()+a(".modal-content").height())>=a(".tbody").height()){b(".evt-down-btn");c(".evt-up-btn");}else{c(".evt-down-btn");}}));},this));}this.modalPanel.find(".modal-content.evt-sort").focus();},selectModalLimiter:function(b){var c=a(b.currentTarget);if(c.is("a")&&c.attr("href")){this.hideModal();this.showLoading();b.preventDefault();b.stopPropagation();window.location=c.attr("href");}},storeModalState:function(){var b=this.checkboxName;this.modalToggleAll=this.modalPanel.find("input.panelToggleAll");this.modalCbAll=this.modalPanel.find('input.panelAllItem[name="'+b+'"]');this.modalCbHidden=this.modalPanel.find('input[type="hidden"][name="'+b+'"]');if(this.modalCbAll.length&&!this.modalCbHidden.length){this.modalCbHidden=jQuery("<input>").attr({type:"hidden",name:b}).val(this.modalCbAll.prop("checked")?this.modalCbAll.val():"");this.modalCbAll.before(this.modalCbHidden);}this.modalCheckboxes=this.modalPanel.find('input[type="checkbox"][name="'+b+'"]');},formSubmit:function(){var b=jQuery("#modalPanelForm").get(0);if(b){b.action=ep.utilities.replaceEPCommand(this.command+"/Update");b.method="post";b.submit();}},hideModal:function(b){this.modalPanel.dialog("close");},scrollUp:function(b){this.smoothScrollModalContent(a(".modal-content").scrollTop()-this.modalWindowHeight);},scrollDown:function(b){this.smoothScrollModalContent(a(".modal-content").scrollTop()+this.modalWindowHeight);},smoothScrollModalContent:function(f){var c=f-a(".modal-content").scrollTop();var b=(navigator.appVersion.match(/MSIE/))?16:4;var d=(c>0)?b:-b;var e=Math.round(c/d);var g=function(){a(".modal-content").scrollTop(a(".modal-content").scrollTop()+d);if(--e){setTimeout(g,0);}};if(e){g();}},checkboxHandler:function(b){var c=a(b.target);if(c.is(this.modalCbAll)){this.toggleAllCbs(!c.prop("checked"));this.modalToggleAll.prop("checked",false);}else{if(!c.is(this.modalToggleAll)&&c.prop("checked")&&this.modalCbAll.length&&this.modalCbAll.prop("checked")){this.toggleAllItem(false);}else{if(c.is(this.modalToggleAll)){this.toggleAllCbs(c.prop("checked"));}else{if(this.modalToggleAll.length){this.modalToggleAll.prop("checked",false);if(!this.modalCheckboxes.not(this.modalCbAll).is(":checked")){this.toggleAllItem(true);}}}}}},toggleAllItem:function(b){this.modalCbAll.prop("checked",b).prop("disabled",b);this.modalCbHidden.val(b?this.modalCbAll.val():"");},toggleAllCbs:function(b){this.modalCheckboxes.not(this.modalCbAll).prop("checked",b);this.toggleAllItem(!b);},sortByHits:function(b){this.sortList(b,"Hits");},sortByName:function(b){this.sortList(b,"Name");},sortList:function(e,f){e.preventDefault();e.stopPropagation();var b=a(e.target);var c=b.parents(".evt-sort").find("input.panelSort");var d=b.parents(".evt-sort").find("input.panelSortOrder");if(c.length){if(c.val()===f){d.val((d.val()==="Desc")?"Asc":"Desc");}else{d.val("");}c.val(f);this.getSortedList("/ExpandedPanel");}},getSortedList:function(d){this.markupUrl=ep.utilities.replaceEPCommand(this.command+d);var c;var b=jQuery("#modalPanelForm");if(b.length){this.updateMethod="post";c=b.serialize();}this.containerId="modal";this.update(c);this.updateMethod="get";},onUpdate:function(){this.onModalLoad();}},"ep.base.ModuleController");});})(jQuery);(function(a){var b;function d(e){var f=ep.utilities.buildAjaxRequestPath("BreadBox/Toggle");a.ajax({type:"get",url:f,data:{theIsExpanded:e}});}a(document).ready(function c(e){ep.getInstance("ep.utilities");b=a("#breadbox");if(!b.length){ep.debug("BreadBoxContainer does not exist in the DOM.  Exiting");return;}b.find(".collapse-toggle").each(function(g,f){var h=jQuery(this).hasClass("active");a(f).bind("click",function(i){h=!h;d(h);});});});})(jQuery);(function(a){ep.registerInstance("ep.controller.page.ehost.ResultListController","ep.base.ResultListController",{createAlertRssLink:null,onDomLoad:function(){this.createAlertRssLink=a("#lnkAlert");this.setEvents();this.initControls();if(ep.clientData.restrictedElements){ep.getInstance({epId:"ep.controller.GuestLoginController",restrictedElements:ep.clientData.restrictedElements});}if(a("#addThis").length&&ep.clientData.addThis){var c=a.browser.msie,b=parseInt(a.browser.version,10),d=(c&&(b<=8))?true:false;ep.require(ep.clientData.addThis.widgetUrl,function(){if(d&&addthis_config){addthis_config.ui_click=false;}setTimeout(function(){addthis.init();},500);});}ep.controller.control.OptionsControlsDropdowns.init();ep.utilities.runQueryStringMethod();},onUnLoad:function(){this.unSetEvents();},initControls:function(){if(a("#DocTypeContainer").length){ep.require("ep/controller/control/doctypecontrol.js");}else{if(a("#multiSelectDocType").length){ep.registerInstance("ep.controller.control.resultlist.SelectMultipleDocTypeController","ep.base.SelectMultipleController",{panelElement:"multiSelectDocType",command:"MultiSelectDocType",messages:this.panelMessages});ep.require("ep/controller/control/doctypecontrol.js");}}if(a("#DbFilterContainer").length){ep.require("ep/controller/control/resultlist/dbfiltercontrol.js");}else{if(a("#multiSelectDbFilter").length){ep.registerInstance("ep.controller.control.resultlist.MultiSelectDbFilterController","ep.base.SelectMultipleController",{panelElement:"multiSelectDbFilter",command:"MultiSelectDbFilter",messages:this.panelMessages});ep.require("ep/controller/control/resultlist/dbfiltercontrol.js");}}_clusterContainer=a("#multiSelectClusterContainer");if(_clusterContainer.length){_clusterContainer.find(".multiSelectPanel").each(a.proxy(function(c,b){ep.registerInstance("ep.controller.control.resultlist.MultiSelectClusterController","ep.base.SelectMultipleController",{panelElement:b.id,command:"MultiSelectCluster",messages:this.panelMessages});},this));}if(a("#integratedSearchControl").length){ep.registerInstance("ep.controller.control.resultlist.ModalEhisPanelController","ep.base.ModalPanelController",{showCloseButton:false,panelElement:"integratedSearchControl",messages:this.panelMessages});}if(a("#resultsLimiterControl").length&&ep.clientData.modalPanelsEnabled){ep.registerInstance("ep.controller.control.resultlist.ModalResultsLimiterPanelController","ep.base.SliderPanelController",{panelElement:"resultsLimiterControl",messages:this.panelMessages});}if(a("#column1").length){ep.getInstance({epId:"ep.controller.CollapsibleController",page:"results"});}if(a("#breadbox").length){ep.require("ep/controller/control/breadboxcontrol.js");}if(ep.clientData.isShowAddFolderPopup){ep.require("ep/controller/control/addtofolderpopup.js");}},setEvents:function(){this.setAddToFolderPopupEvents(false);this.setClickEvents(false);this.setSearchHistoryEvents(false);},unSetEvents:function(){this.setAddToFolderPopupEvents(true);this.setClickEvents(true);this.setSearchHistoryEvents(true);},setAddToFolderPopupEvents:function(f){var d=a.proxy(this.handlers.addToFolderPopupLinkClick,this);function c(g){d(g,g.data,true);}function b(g){d(g,g.data,false);}if(ep.clientData.isShowAddFolderPopup){a('a[id^="add_"]').each(function(){var g=a(this).data("folder").resultID;a(this).attr("onclick","");a(this).attr("href","#");a(this)[f?"unbind":"bind"]("click",g,c);});a('a[id^="added_"]').each(function(){var g=a(this).data("folder").resultID;a(this).attr("onclick","");a(this).attr("href","#");a(this)[f?"unbind":"bind"]("click",g,b);});var e=a("#lnkAddAll").first();if(e.length){e.attr("onclick","");e.attr("href","#");e[f?"unbind":"bind"]("click",a.proxy(this.handlers.addMultiToFolderPopupLinkClick,this));}}},setSearchHistoryEvents:function(h){var j=a.proxy(this.handlers.showEditSearchHistoryModalClick,this);function c(k){j(k,k.data.SearchId);}var e=a(".saveSearchLink").first();if(e.length){e[h?"unbind":"bind"]("click",a.proxy(this.handlers.saveSelectedSearches,this));}var d=a(".printSearchLink").first();if(d.length){d[h?"unbind":"bind"]("click",a.proxy(this.handlers.printSelectedSearches,this));}var f=a("#tblSearchHistory");var b;var g;if(f.length&&ep.clientData.isShowEditHistoryModal){b=f.find(".editSearch");for(i=0;i<b.length;i++){aElement=a(b[i]).children().first();g=a(b[i]).parent().siblings(".searchID").children().first().html();if(aElement.length&&g){aElement[h?"unbind":"bind"]("click",{SearchId:g},c);}}}},setClickEvents:function(b){if(this.createAlertRssLink.length){this.createAlertRssLink[b?"unbind":"bind"]("click",this.handlers.createAlertModalClick);}},handlers:{createAlertModalPopupLinkClick:a.proxy(function(c){c.preventDefault();var b=ep.getInstance({epId:"ep.controller.control.AlertModalModule"});if(b){b.showModal();}ep.dialog.ToggledPopup.closeDialog();},this),createAlertModalClick:a.proxy(function(c){c.preventDefault();var b=ep.getInstance({epId:"ep.controller.control.AlertModalModule"});if(b){b.showModal();}ep.dialog.ToggledPopup.closeDialog();},this),saveSelectedSearches:function(d){d.preventDefault();var b="searchhistory/SaveSelectedSearches";var c="";for(var e=1;a("#searchHistoryCheckBox_S"+e).length;e++){if(a("#searchHistoryCheckBox_S"+e).is(":checked")){c+="S"+e+",";}}window.location=ep.utilities.replaceEPCommand(b)+"&theSearchHistoryIds="+c;},printSelectedSearches:function(e){e.preventDefault();var b="searchhistory/PrintSearchHistory";var d="";for(var f=1;a("#searchHistoryCheckBox_S"+f).length;f++){if(a("#searchHistoryCheckBox_S"+f).is(":checked")){d+="S"+f+",";}}var c=ep.utilities.replaceEPCommand(b);openprintSearchHistory(c+"&theSearchHistoryIds="+d);},showEditSearchHistoryModalClick:function(c,d){c.preventDefault();var b=ep.getInstance({epId:"ep.controller.control.EditSearchHistoryModalModule",params:{theSearchHistory:d}});if(b){b.showModal({theSearchHistory:d});}},addToFolderPopupLinkClick:function(b,d,c){b.preventDefault();ep.controller.control.AddToFolderPopup.showAddToFolderPopup(b,{theResultId:d,theIsResultList:true,theIsToggleIcon:c});},addMultiToFolderPopupLinkClick:function(b){b.preventDefault();ep.controller.control.AddToFolderPopup.showAddToFolderPopup(b,{theIsMulti:true,theIsResultList:true});}}});})(jQuery);ep.register("ep.controller.control.BookJackets");ep.controller.control.BookJackets=(function(a){function c(h,f){var g=a(f);var e=g.data("book-jacket");if(e&&e.ThumbImageUrl&&e.ThumbImageUrl.length>0){a("<img />").load(function(){if(this.width>1||this.naturalWidth>1){g.prepend(a(this));a(this).wrapAll('<span class="bj-img"></span>');g.removeClass();if(e.Type===3){g.addClass("book-jacket-series");}else{g.addClass("book-jacket");}}else{a(this).remove();}}).attr({src:e.ThumbImageUrl,alt:e.ToolTip});}}function d(h,f){var g=a(f);var e=g.data("book-jacket");if(e&&e.ThumbImageUrl&&e.ThumbImageUrl.length>0){a("<img />").load(function(){if(this.width>1||this.naturalWidth>1){g.prepend(a(this));a(".pubtype-icon",g).remove();if(a.browser.msie){a(this).removeAttr("height").removeAttr("width");}a(this).attr("width","60px");a(this).attr("data-auto","book_jacket");g.removeClass("pubtype");if(e.Type===3){g.addClass("book-jacket-series");}else{g.addClass("book-jacket");}}else{a(this).remove();}}).attr({src:e.ThumbImageUrl,alt:e.ToolTip});}}function b(h,f){var g=a(f);var e=g.data("book-jacket");if(e&&e.ThumbImageUrl&&e.ThumbImageUrl.length>0){a("<img />").load(function(){if(this.width>1||this.naturalWidth>1){g.prepend(a(this));if(e.DetailImageUrl!==null&&a.trim(e.DetailImageUrl).length>0){a(this).wrapAll('<a href="'+e.DetailImageUrl+'" target="_blank"></a>');}if(a.browser.msie){a(this).removeAttr("height").removeAttr("width");}}else{a(this).remove();}}).attr({src:e.ThumbImageUrl,alt:e.ToolTip});}}return{loadResultBookJacketForMobile:function(e){a(e).find(".mobile-jacket[data-book-jacket]").each(c);},loadResultBookJacket:function(){a(".record-icon[data-book-jacket]").each(d);},loadDetailBookJacket:function(){a("#bookJacket[data-book-jacket]").each(b);},loadMobileResultBookJacket:function(){a(".mobile-jacket[data-book-jacket]").each(c);}};})(jQuery);(function(a){a(function(){ep.controller.control.BookJackets.loadDetailBookJacket();ep.controller.control.BookJackets.loadResultBookJacket();ep.controller.control.BookJackets.loadMobileResultBookJacket();});})(jQuery);