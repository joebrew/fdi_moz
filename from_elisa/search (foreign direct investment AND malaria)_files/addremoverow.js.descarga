(function(a){function c(){e();}function e(){a("#guided-find-fields").on("click","#AddRow",function(){b();});a("#guided-find-fields").on("click","#RemoveRow",function(){d();});}function b(){var m=a("#AddRow").data("count");var p=m.maxCount;var q=m.minCount;var l=a("#guidedfindfieldRows > li").length;if(!a("#AddRow").hasClass("disabled")){if(l<p){var o=a("#guidedfindfieldRows > li").last();var r=o.clone();r.find("input[type=text]").val("");r.find("input[type=hidden]").val(l+1);var h=r.find('[data-add-remove="inputOp"]'),i=r.find('[data-add-remove="labelOp"]');h.each(function(v){a(this).attr({id:"Op_"+(l+1)+"_"+_.last(a(this).attr("id").split("_")+"_"+v),name:"GuidedSearchFormData["+(l+1)+"].Op"});});i.each(function(v){a(this).attr({"for":"Op_"+(l+1)+"_"+_.last(a(this).attr("for").split("_")+"_"+v)});});r.find("input[type=text]").attr("name","GuidedSearchFormData["+(l+1)+"].SearchTerm");var k=r.find("input[type=text]").attr("id","Searchbox"+(l+1));var n=r.find("[data-searchTextBox]");if(n.length>0){r.find("input[type=text]").attr("data-searchtextbox",'{"AutoSuggestMapId":"Searchbox'+(l+1)+'"}');}r.find("label:last").attr("for","Op_"+(l+1));var f=r.find('[data-add-remove="inputDb"]'),g=r.find('[data-add-remove="labelDb"]');f.each(function(v){a(this).attr({name:"GuidedSearchFormData["+(l+1)+"].DbTag",id:"DbTag_"+(l+1)+"_"+v});});g.each(function(v){a(this).attr({"for":"DbTag_"+(l+1)+"_"+v});});k.bidiDirFixer();var t=(a.browser.msie)?"keydown paste":"keyup";var u=(a.browser.msie)?50:1;k.on(t,function(w){var v=this;setTimeout(function(){a(v).bidiDirFixer();},u);return true;});r.find("select:first option:first-child").attr("selected","selected");a("#guidedfindfieldRows").append(r);r.find("[data-dropdown]").dropdown();f.first().click();if(n.length>0){var j=a("#Searchbox"+(l+1)),s=j.closest(".find-field-controls").data("autoComplete");j.epautocomplete({data:s});}l=a("#guidedfindfieldRows > li").length;if(l>q){a("#RemoveRow").removeClass("disabled");}if(l===p){a("#AddRow").removeClass().addClass("disabled");}}}}function d(){var g=a("#RemoveRow").data("count");var h=g.maxCount;var i=g.minCount;var f=a("#guidedfindfieldRows > li").length;if(!a("#RemoveRow").hasClass("disabled")){if(f>i){a("#guidedfindfieldRows > li").last().remove();f=a("#guidedfindfieldRows > li").length;if(f<h){a("#AddRow").removeClass("disabled");}if(f===i){a("#RemoveRow").addClass("disabled");}}}}a(c);})(jQuery);